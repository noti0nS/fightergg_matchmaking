CREATE TABLE IF NOT EXISTS GAMES (
  ID SERIAL PRIMARY KEY,
  TITULO VARCHAR(64) NOT NULL UNIQUE,
  DESCRICAO VARCHAR(255)
);
CREATE TABLE IF NOT EXISTS USUARIOS (
  ID SERIAL PRIMARY KEY,
  NOME_COMPLETO VARCHAR(128) NOT NULL,
  NICKNAME VARCHAR(32) NOT NULL UNIQUE,
  EMAIL VARCHAR(150) NOT NULL UNIQUE,
  SENHA VARCHAR(96) NOT NULL,
  BALANCE NUMERIC(12, 2) NOT NULL DEFAULT 0
);
CREATE TABLE IF NOT EXISTS EVENTOS (
  ID SERIAL PRIMARY KEY,
  OWNER_ID INT REFERENCES USUARIOS (ID),
  GAME_ID INT REFERENCES GAMES (ID),
  WINNER_ID INT,
  TITULO VARCHAR(80) NOT NULL UNIQUE,
  DESCRICAO VARCHAR(255) NOT NULL,
  DATA_INSCR DATE NOT NULL,
  QTD_PLAYERS INT NOT NULL,
  EM_ANDAMENTO BOOLEAN NOT NULL DEFAULT FALSE,
  VALOR_RECOMPENSA NUMERIC(12, 2) NOT NULL DEFAULT 0
);
CREATE TABLE IF NOT EXISTS EVENTOS_TICKETS (
  ID SERIAL PRIMARY KEY,
  EVENTO_ID INT REFERENCES EVENTOS (ID) ON DELETE CASCADE,
  USUARIO_ID INT REFERENCES USUARIOS (ID),
  UNIQUE (EVENTO_ID, USUARIO_ID)
);
CREATE TABLE IF NOT EXISTS EVENTOS_PARTIDAS (
  ID SERIAL PRIMARY KEY,
  EVENTO_ID INT REFERENCES EVENTOS (ID) ON DELETE CASCADE,
  PLAYER1_ID INT,
  PLAYER2_ID INT,
  WINNER_ID INT,
  NEXT_MATCH_ID INT,
  ROUND INT NOT NULL,
  ROUND_GAME INT NOT NULL DEFAULT 1
);